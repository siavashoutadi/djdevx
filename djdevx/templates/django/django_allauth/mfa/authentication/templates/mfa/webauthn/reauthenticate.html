{% extends "../../allauth_base.html" %}
{% load i18n %}
{% load static %}
{% block title %}
    {% trans "Authenticate with Security Key" %}
{% endblock title %}
{% block content %}
<div class="flex flex-1 flex-col justify-center px-6 py-12 lg:px-8">
  <div class="sm:mx-auto sm:w-full sm:max-w-md">
    <h1 class="text-center text-2xl font-bold leading-9 tracking-tight">{% trans "Use a Security Key" %}</h1>
    <p class="mt-4 text-center text-gray-700 dark:text-gray-200">{% trans "Please authenticate with your security key." %}</p>
  </div>
  <div class="mt-8 sm:mx-auto sm:w-full sm:max-w-md">
    <form method="post" class="space-y-6" id="webauthn_reauthenticate_form">
      {% csrf_token %}
      {{ form.as_p }}
      <div class="flex gap-3">
        <button type="button" id="mfa_webauthn_reauthenticate"
                class="flex-1 flex justify-center rounded-md px-3 py-1.5 text-sm font-semibold leading-6 shadow-sm bg-black text-white hover:bg-slate-900 dark:bg-transparent dark:outline dark:outline-white dark:text-white dark:hover:text-gray-400 dark:hover:outline-gray-400">
          {% trans "Authenticate" %}
        </button>
        <a href="{{ back_url }}"
           class="flex-1 flex justify-center rounded-md px-3 py-1.5 text-sm font-semibold leading-6 shadow-sm border border-gray-300 bg-white text-black hover:bg-gray-100 dark:border-gray-600 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700">
          {% trans "Cancel" %}
        </a>
      </div>
    </form>
    {% include "mfa/webauthn/snippets/scripts.html" %}
    {{ js_data|json_script:"js_data" }}
    <script data-allauth-onload="allauth.webauthn.forms.authenticateForm" type="application/json">{
    "ids": {
        "authenticate": "mfa_webauthn_reauthenticate",
        "credential": "{{ form.credential.auto_id }}",
        "data": "js_data"
    }
}
    </script>
  </div>
</div>
{% endblock content %}
