import os
import environ
from dotenv import load_dotenv

from settings import BASE_DIR

LOCAL_ENV_FILE = os.path.join(BASE_DIR, ".environments", "dev")
SWARM_ENV_FILE = os.path.join("run", "secrets", "{{ project_name }}-secret")


def get_env():
    env = environ.Env()
    if is_local():
        load_dotenv(LOCAL_ENV_FILE)
    elif is_swarm():
        load_dotenv(SWARM_ENV_FILE)

    return env


def is_local():
    return os.path.exists(LOCAL_ENV_FILE) and not is_docker()


def is_docker():
    return os.path.exists("/.dockerenv")


def is_swarm():
    return is_docker() and os.path.exists(SWARM_ENV_FILE)
